
# End goal: Require user authentication for @apps/ui

# Existing Components
- @apps/ui is a react app that is compiled and served as static files via @apps/backend
- @apps/backend has an authorisation server designed for MCP, but nothing is stopping us from using it for web

# Mising Components
- Identity Provider: currently we don't have one, so there really isn't any way to do authentication (login)
- UI/Backend JWT triage: currently all requests are open

# Phase 1: Identity Provider
## Backend only
- Decouple IdP from token logic, because in the future I'll swap the IdP. Input for IdP is username and password. Output is an ID representation of the user. Say name, email, etc.
- User tables via entities. User can be admin or standard.
- Service to login (verifies username and password, returns user info)
- No controllers, this is purely internal
- For username, let's use email.
- Create a way for me to manually create an admin user.

# Phase 2: Login method
## Backend
- Use IdP service to verify Username & Password.
- Separate module to issue a short lived bearer JWT for the front end. (access token good for 10 minutes, refresh token good for 1 day).
- Scopes are `monolith:user` and `monolith:admin`. Depending on what comes back from the IdP assign one or both.

## Frontend
- Implement login page where the user enters their username and password.
- Frontend stores JWT somehow and uses that for API calls. I don't know how to do this. Use best practices.
- Pages don't load without a valid JWT. It redirects you to login page.

# Phase 3: JWT verification for API calls
The frontend interacts with the backend a lot. Right now all calls are open.
Implement authorisation across the backend. Maybe a simple guard that inspects the JWT and validates scopes (for now `monolith:user` for everything, we'll layer in the admin later).

